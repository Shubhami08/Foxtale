<style>
  .newshop-wrap {
    background-color: #e4e4e4;
    padding: 16px 0px 0px 0;
  }
  .newshop-wrap h3 {
    font-size: 22px;
    background-color: transparent;
    color: #2C2C2C;
    font-weight: 500;
    padding: 10px 35px;
  }
  .newshop-inwrapped {
    margin: 20px 33px;
    border-radius: 4px;
    background-color: #ffffff;
    padding: 16px 30px 8px 30px;
  }
  .round-outerwrapper {
    border-radius: 8px;
    margin: 0 33px 20px 33px;
    background-color: #ffffff;
    padding: 12px 0;
    width: 100%;
    box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.25);
  }
  .round-wrapper {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    grid-column-gap: 28px;
    border-bottom: 2px solid #e1e1e1;
    background-color: #ffffff;
    max-width: 585px;
    margin: 0 auto;
    border-bottom-left-radius: 2px;
    border-bottom-right-radius: 2px;
  }
  .round-collectionimg {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    position: relative;
  }
  . {
    content: '';
    position: absolute;
    width: 100%;
    left: 0;
    bottom: -1px;
    border-bottom: 2px solid #000000;
    border-radius: 1px;
  }
  .newshop-layout {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr 1fr;
    grid-column-gap: 58px;
    grid-row-gap: 16px;
    margin-bottom: 12px;
  }
  .newshop-differenciate {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: flex-start;
  }
  .newshop-differenciate h4 {
    color: #2C2C2C;
    font-size: 20px;
    font-weight: 500;
  }
  .newshop-differenciate p {
    margin: 0 0 16px 0;
    color: #6E6E6E;
    font-size: 12px;
    font-weight: 400;
  }
  .newshop-layout .pr-img-first, .newshop-layout .pr-img-second {
    border-top-left-radius: 4px !important;
    border-top-right-radius: 4px !important;
  }
  .newstickynav-template .newshop-layout .pr-img-first, .newstickynav-template .newshop-layout .pr-img-second {
    border-top-left-radius: 0px !important;
    border-top-right-radius: 0px !important;
  }
  .newshop-wrap .product-info {
    margin-bottom: 0;
  }
  .product-innr {
    box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.25);
  }
  .newshop-wrap .price .t4s-product-price {
    padding: 0 0px 0 8px;
    display: none;
  }
  .newshop-layout .price .t4s-product-price.active {
    display: flex;
    flex-direction: row-reverse;
  }
  .round-collectionimg.active:before {
    content: '';
    position: absolute;
    width: 100%;
    left: 0;
    bottom: -3px;
    border-bottom: 3px solid #000000;
    border-radius: 2px;
  }
  .newshop-wrap .shop-all-qty-cart-btn {
    padding: 0px 0 0px 0 !important;
    margin-top: 0 !important;
  }
  .newshop-wrap .product-innr>h6 {
    background: #000000;
    font-size: 12px;
    line-height: 18px;
    align-items: center;
    padding: 2px 5px 2px 10px;
    text-transform: uppercase;
    color: #FFF;
    font-weight: 500;
    letter-spacing: 3.6px;
    display: flex;
    justify-content: center;
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
  }
  .newshop-wrap .products-grid-item {
    padding: 0!important;
  }
  .newshop-wrap .collection-name {
    font-size: 35px;
    font-weight: 500;
    line-height: 32px;
    color: #000000;
    margin-bottom: 18px;
  }
  .collectio-name {
    margin: 8px 0 3px 0;
    font-size: 14px;
    font-weight: 400;
    color: #2c2c2c;
  }
  .active .collectio-name {
    /* font-weight: 500; */
    color: #000000;
  }
  .newshop-rounddesk {
    display: block;
  }
  .newshop-roundmobile {
    display: none;
  }
  span.badge.price__badge-sale.color- {
    position: absolute;
    color: #f05001;
    padding: 8px;
    background-color: #ffffff;
    border-radius: 50%;
    font-size: 15px;
    font-weight: 500;
    top: 28px;
    left: 22px;
    display: none;
  }
  .save-badge {
    position: absolute;
    color: #f05001;
    padding: 8px;
    background-color: #ffffff;
    border-radius: 50%;
    font-size: 15px;
    font-weight: 500;
    top: 28px;
    left: 22px;
    display: none;
  }
  .newshop-wrap ins.dcba {
    padding-right: 10px;
  }

  @media (max-width: 768px) {
    span.badge.price__badge-sale.color- {
      font-size: 12px;
      font-weight: 500;
      top: 8px;
      left: 10px;
      padding: 6px;
    }
    .newshop-wrap {
      padding: 0px 0px 0px 0;
    }
    .newshop-wrap h3 {
      background-color: #ffffff;
      font-size: 18px;
      padding: 0 12px;
    }
    .round-wrapper {
      grid-column-gap: 8px;
    }
    .newshop-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-column-gap: 6px;
      grid-row-gap: 12px;
    }
    .newshop-wrap .collection-name {
      font-size: 20px;
      font-weight: 400;
      line-height: 32px;
      margin-bottom: 0px;
    }
    .container.custom_design_1.foxtale_scroll.newshop-wrap {
      padding: 0 12px !important;
      margin: 30px 0 0 0 !important;
    }
    .newshop-inwrapped {
      margin: 8px 6.5px 12px 6.5px;
      padding: 10px 6px 1px 6px;
    }
    .round-outerwrapper {
      border-radius: 0px;
      margin: 0 0px 12px 0px;
      padding: 22px 10px 6px 10px;
    }
    .newshop-differenciate {

    }
    .newshop-differenciate h4 {
      font-size: 16px;
    }
    .newshop-differenciate p {
      font-size: 11px;
    }
    .newshop-wrap .fera-productReviewsSummary .fera-productReviewsSummary-avgRating {
      margin-left: 0px;
    }
    .collectio-name {
      font-size: 12px;
      margin: 8px 0 0px 0;
    }
    .newshop-rounddesk {
      display: none;
    }
    .newshop-roundmobile {
      display: block;
    }
  }

  @media (max-width: 1000px) and (min-width: 768px) {
    .newshop-layout {
      grid-template-columns: 1fr 1fr 1fr;
    }
  }

  @media (max-width: 500px) {
    .template-index.-template .container.custom_design_1.foxtale_scroll.newshop-wrap {
      padding: 0 0px 25px 0 !important;
      margin: 4px 0 0 0 !important;
    }
    .template-index .foxtale_scroll.newshop-wrap .tab-slider-main .products-grid-item {
      padding: 0 2px !important;
    }
    .container.custom_design_1.foxtale_scroll.newshop-wrap .allAtToCart .aatcrtnone {
      font-size: 10px;
      letter-spacing: 1px;
      padding: 8px 38px;
    }
    .container.custom_design_1.foxtale_scroll .allAtToCart .aatcrtnone {
      font-size: 14px;
      font-weight: 600;
      letter-spacing: 1.1px;
      padding: 8px 28px;
      width: max-content;
      margin: 0 auto;
    }
    .newshop-roundmobile img {
      width: 90px;
      height: 90px;
    }
    /* New Changes 17th April */
    .newshop-wrap h3 {
      font-size: 18px;
    }
    .round-outerwrapper {
      padding: 15px 0px 6px 0px;
    }
    .newstickynav-template .round-wrapper {
      grid-column-gap: 3px;
    }
    .newstickynav-template .collectio-name {
      font-size: 10px;
      margin: 0px 0 5px 0;
    }
    .newshop-wrap .product-info .product-title {
      text-overflow: unset;
      display: flex;
      -webkit-line-clamp: unset;
      -webkit-box-orient: unset;
    }
    .newshop-wrap .product-info .fx-tags-shop {
      padding-top: 0px !important;
    }
  }

  @media (max-width: 400px) {
    .newstickynav-template .collectio-name {
      font-size: 10px;
    }
    .newstickynav-template .round-wrapper {
      grid-column-gap: 0px;
    }
  }
</style>

<div class="newshop-wrap">
  <h3>{{ section.settings.heading }}</h3>
  <div class="round-outerwrapper" id="navigation">
    <div class="round-wrapper">
      {% for block in section.blocks %}
        {% assign collection = block.settings.collekt %}
        <div class="round-collectionimg {% if forloop.first %}active{% endif %}" data-tab="tab_{{ forloop.index }}">
          <div class="newshop-rounddesk">
            {%- if block.settings.mdlpik != blank -%}
              <img src="{{ block.settings.mdlpik | img_url: '105x105' }}">
            {%- endif -%}
          </div>
          <div class="newshop-roundmobile">
            {%- if block.settings.smlpik != blank -%}
              <img src="{{ block.settings.smlpik | img_url: 'master' }}">
            {%- endif -%}
          </div>
          <p class="collectio-name">{{ block.settings.txter }}</p>
        </div>
      {% endfor %}
    </div>
  </div>
  {% for block in section.blocks %}
    {% assign collection = block.settings.collekt %}
    <div class="newshop-inwrapped" id="tab_{{ forloop.index }}">
      <div class="newshop-differenciate">
        <h4>{{ block.settings['grid-heading'] }}</h4>
        <p>{{ block.settings['grid-subheading'] }}</p>
      </div>
      <div class="newshop-layout">
        {%- for product in collection.products limit: 10 -%}
          <div class="products-grid-item">
            <div class="product-innr">
              {% comment %}
                {% if product.metafields.custom.pr_excerpt != blank %}
                  <h6 class="pr-{{ product.metafields.custom.pr_excerpt }}">
                    {{ product.metafields.custom.pr_excerpt }}
                  </h6>
                {% endif %}
              {% endcomment %}
              <div class="product-image pr oh lazyloadt4sed product-innr-top">
                <a rel="dofollow" href="{{product.url}}">
                  {%- render 'product_labels', on: 'singe', product: product -%}
                  
   {%- if product.price < product.compare_at_price -%}
      {%- assign savings = product.compare_at_price | minus: product.price | times: 100.0 | divided_by: product.compare_at_price | round | append: '%' -%}
      <span class="badge price__badge-sale color-{{ settings.sale_badge_color_scheme }}">{{ savings }}</span>
	{% else %}
    <span class="badge price__badge-sale color-{{ settings.sale_badge_color_scheme }}">
      {{ 'products.product.on_sale' | t }}
    </span>
    {%- endif -%}

    {%- if product.metafields.custom.savingscustom != blank -%}
      <span class="save-badge">{{ product.metafields.custom.savingscustom }}</span>
    {%- endif -%}
                  
                  <img
                    class="pr-img-first lazyload"
                    loading="lazy"
                   src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' fill='%23282828'%3E%3Crect x='-50' y='20' width='50' height='10' fill='%23ccc'%3E%3Canimate attributeName='x' attributeType='XML' values='-50;100;' dur='1.5s' repeatCount='indefinite'/%3E%3C/rect%3E%3Crect x='-50' y='35' width='50' height='10' fill='%23ccc'%3E%3Canimate attributeName='x' attributeType='XML' values='-50;100;' dur='1.5s' repeatCount='indefinite'/%3E%3C/rect%3E%3C/svg%3E"
                     data-src="{{ product.images[0] | product_img_url: "master" }}"
                    alt="Product Image"
                  >
                  <img
                    class="pr-img-second lazyload"
                    loading="lazy"
                    src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 50' width='50' height='50' fill='%23282828'%3E%3Crect x='-50' y='20' width='50' height='10' fill='%23ccc'%3E%3Canimate attributeName='x' attributeType='XML' values='-50;100;' dur='1.5s' repeatCount='indefinite'/%3E%3C/rect%3E%3Crect x='-50' y='35' width='50' height='10' fill='%23ccc'%3E%3Canimate attributeName='x' attributeType='XML' values='-50;100;' dur='1.5s' repeatCount='indefinite'/%3E%3C/rect%3E%3C/svg%3E"
                     data-src="{{ product.images[0] | product_img_url: "master" }}"
                    alt="Product Image"
                  >
                </a>
                <div
                  data-fera-container="457325"
                  data-product_id="{{ product.id }}"
                  class="reviewContainerDiv on-productpic"
                ></div>
              </div>
              <div class="product-info mt__15 mb__10 product-innr-bottom rtn-adjst">
                <div class="pr-det">
                  <h3 class="product-title pr fs__14 mg__0 fwm">
                    <a rel="dofollow" class="cd chp" href="{{product.url}}">{{ product.title }}</a>
                  </h3>
                  {% if product.metafields.my_fields.hp_excerpt != blank %}
                    <p class="fx-tags-shop fx-{{ product.metafields.my_fields.hp_excerpt | downcase | replace: " ", "-" }}">
                      {{ product.metafields.my_fields.hp_excerpt }}
                    </p>
                  {% endif %}
                </div>
                {% comment %}<p style="font-size: 14px; font-weight: 400; -webkit-letter-spacing: 0; -moz-letter-spacing: 0; -ms-letter-spacing: 0; color: #fc2779; margin-bottom: 0;">Free Gift Worth â‚¹150</p>{% endcomment %}
                    <span class="price dib mb__5">
                      {%- for variant in product.variants -%}
                        {% assign pr_option = variant.options | downcase | replace: '"', '' %}
                        {% assign pr_option = pr_option | replace: ' ', '-' %}
                        {% assign pr_option = pr_option | replace: '[', '' %}
                        {% assign pr_option = pr_option | replace: ']', '' %}
                        <div class="t4s-product-price {{ pr_option }}{% if forloop.first %} active{% endif %}">
                          {% if variant.compare_at_price > variant.price %}
                            <del>{{ variant.compare_at_price | money_with_currency }}</del
                            ><ins class="dcba">{{ variant.price | money_with_currency }}</ins>
                          {% else %}
                            {{ variant.price | money_with_currency }}
                          {% endif %}
                        </div>
                      {% endfor %}
                    </span>
                <div class="discount-msg">
                  <p class="bottom-leftext">B2G2</p>
                  <p class="bottom-rightext">Free Gift</p>
                </div>
              </div>
            </div>
            
            {% if product.metafields.custom.check_variant %}
                <div class="shop-all-qty-cart-btn">
                    <a href="{{ product.url }}" class="fx-custom-btn-dark t4s-pr-item-btn t4s-pr-addtocart"><span class="t4s-svg-pr-icon"></span><span class="t4s-text-pr">Select Shade</span></a>
                </div>
            {% else %}
              <div class="shop-all-qty-cart-btn">
              <a
                href="{{ product.url }}"
                id="addtocart_r"
                class="fx-custom-btn-dark t4s-pr-item-btn t4s-pr-addtocart"
                data-variant-id="{{product.first_available_variant.id}}"
                data-action-atc
                rel="dofollow"
                ><span class="t4s-svg-pr-icon"></span
                ><span class="t4s-text-pr">{{ 'products.product.add_to_cart' | t }}</span></a
              >
            </div>
            {% endif %}
          </div>
        {%- endfor -%}
      </div>
    </div>
  {% endfor %}
</div>

<script>
  $(document).ready(function () {
    $(document).on("click",".round-wrapper .round-collectionimg",function() {
      var active_tab = $(".round-wrapper .round-collectionimg.active").attr("data-tab");
      var current_tab = $(this).attr("data-tab");
      // $(this).parents(".round-wrapper").find(".round-collectionimg").removeClass("active");
      // $(this).addClass("active");
      var userAgent = navigator.userAgent;

      // Check if the user is using an iPhone
      if (userAgent.match(/iPhone/i)) {
          console.log('User is using an iPhone');
          var for_tab_1 = -20;
          var for_tab_first_time = 0;
          var for_tab_click = -30;
      }else{
          var for_tab_1 = 0;
          var for_tab_first_time = -30;
          var for_tab_click = -10;
      }

      if($(window).width() < 767){
        if(current_tab == "tab_1"){
          $('html, body').animate({
            'scrollTop' : $(".newshop-wrap").position().top + for_tab_1
          });
        }else{
          if(!$('#navigation').hasClass("scetion_fixed")){
            $('html, body').animate({
              'scrollTop' : $('#'+current_tab).position().top + for_tab_first_time
            });
          }else{
            $('html, body').animate({
              'scrollTop' : $('#'+current_tab).position().top + for_tab_click
            });
          }
        }
      } else {
        if(current_tab == "tab_1"){
          $('html, body').animate({
            'scrollTop' : $(".newshop-wrap").position().top + 130
          });
        }else{
          if(!$('#navigation').hasClass("scetion_fixed")){
            $('html, body').animate({
              'scrollTop' : $('#'+current_tab).position().top - 55
            });
          }else{
            $('html, body').animate({
              'scrollTop' : $('#'+current_tab).position().top - 35
            });
          }
        }
      }


    });
  });
</script>

<script>
  var elementPosition = $('#navigation').offset();
    var userAgent = navigator.userAgent;
    if (userAgent.match(/iPhone/i)) {
          var scroll_manage = -30;
      }else{
          var scroll_manage = -60;
      }


  $(window).scroll(function(){
    var tab_1_pos = $(".newshop-inwrapped#tab_1").offset().top - $(".round-outerwrapper").outerHeight() + scroll_manage;
    var tab_2_pos = $(".newshop-inwrapped#tab_2").offset().top - $(".round-outerwrapper").outerHeight() + scroll_manage;
    var tab_3_pos = $(".newshop-inwrapped#tab_3").offset().top - $(".round-outerwrapper").outerHeight() + scroll_manage;
    var tab_4_pos = $(".newshop-inwrapped#tab_4").offset().top - $(".round-outerwrapper").outerHeight() + scroll_manage;
    if($(window).scrollTop() > tab_1_pos && $(window).scrollTop() < tab_2_pos){
      if(!$('.round-collectionimg[data-tab="tab_1"]').hasClass("active")){
        $(".round-wrapper .round-collectionimg").removeClass("active");
        $('.round-collectionimg[data-tab="tab_1"]').addClass("active");
      }
    }else if($(window).scrollTop() > tab_2_pos && $(window).scrollTop() < tab_3_pos){
      if(!$('.round-collectionimg[data-tab="tab_2"]').hasClass("active")){
        $(".round-wrapper .round-collectionimg").removeClass("active");
        $('.round-collectionimg[data-tab="tab_2"]').addClass("active");
      }
    }else if($(window).scrollTop() > tab_3_pos && $(window).scrollTop() < tab_4_pos){
      if(!$('.round-collectionimg[data-tab="tab_3"]').hasClass("active")){
        $(".round-wrapper .round-collectionimg").removeClass("active");
        $('.round-collectionimg[data-tab="tab_3"]').addClass("active");
      }
    }else if($(window).scrollTop() > tab_4_pos){
      if(!$('.round-collectionimg[data-tab="tab_4"]').hasClass("active")){
        $(".round-wrapper .round-collectionimg").removeClass("active");
        $('.round-collectionimg[data-tab="tab_4"]').addClass("active");
      }
    }

    if($(window).scrollTop() > elementPosition.top){
          $('#navigation').css('position','fixed').css('top','0').css('z-index','3').addClass("scetion_fixed");
      if($(window).width() < 767){
          $('.newshop-wrap #tab_1').css('margin-top',$(".round-outerwrapper").outerHeight() + 20);
      }else{
        $('.newshop-wrap #tab_1').css('margin-top',$(".round-outerwrapper").outerHeight());
      }
    } else {
        $('#navigation').css('position','static').removeClass("scetion_fixed");
        $('.newshop-wrap #tab_1').css('margin-top',0);
    }
  });
</script>

{% schema %}
{
  "name": "New Layout Shop",
  "settings": [
    {
      "id": "heading",
      "type": "text",
      "label": "Section Heading"
    }
  ],
  "blocks": [
          {
            "name": "Content",
            "type": "text",
            "settings": [
          {
            "id": "collekt",
            "type": "collection",
            "label": "Add Collection"
          },
          {
            "id": "txter",
            "type": "text",
            "label": "Main-Title"
          },
          {
            "id": "mdlpik",
            "type": "image_picker",
            "label": "Desktop Collection Image"
          },
          {
            "id": "smlpik",
            "type": "image_picker",
            "label": "Mobile Collection Image"
          },
          {
            "id": "grid-heading",
            "type": "text",
            "label": "Grid Heading"
          },
          {
            "id": "grid-subheading",
            "type": "text",
            "label": "Grid Sub-Heading"
          }
      ]
    }
  ],
  "presets": [
    {
      "name": "New Layout Shop",
      "category": "Any"
    }
  ]
}
{% endschema %}